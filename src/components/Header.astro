---
const navItems = [
  {
    title: 'home',
    path: '/',
    subPaths: []
  },
  {
    title: 'about',
    path: '#', // Dropdown trigger
    subPaths: [
      { title: 'Mission', path: '/mission' },
      { title: 'Team & Culture', path: '/team-and-culture' },
      { title: 'Open Source Innovation', path: '/open-source' }
    ]
  },
  {
    title: 'contact',
    path: '/contact',
    subPaths: []
  }
];

const currentPath = Astro.url.pathname;
---

<header class="max-w-screen-xl m-auto px-4">
  <nav class="flex h-20 items-center justify-between">
    <a href="/">
      <img src="https://gluelabs.com/images/logo.svg" loading="lazy" alt="Glue labs logo" class="w-20 lg:w-24">
    </a>
    
    <!-- Desktop Menu -->
    <div class="hidden h-full space-x-8 md:flex">
      {navItems.map((item) => (
        item.subPaths.length > 0 ? (
          <div class="group relative flex h-full cursor-pointer items-center space-x-2 font-jost capitalize lg:text-xl">
            <span class={`line-effect ${currentPath.startsWith(item.path) && item.path !== '#' ? 'page-active' : ''}`}>
              {item.title}
            </span>
            <svg width="18" height="18" class="text-black transition ease-in group-hover:rotate-180" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 256 256"><rect width="256" height="256" fill="none"></rect><polyline points="208 96 128 176 48 96" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></polyline></svg>
            
            <div class="absolute top-full right-0 z-10 hidden min-w-max space-y-2 rounded-b-lg bg-white p-4 shadow-light group-hover:block">
              {item.subPaths.map((subItem) => (
                <a href={subItem.path} class="flex w-full items-center rounded-md p-2 text-sm text-grey-400 hover:bg-secondary-light hover:text-secondary lg:text-base">
                  <span>{subItem.title}</span>
                </a>
              ))}
            </div>
          </div>
        ) : (
          <a class="group flex h-full items-center font-jost capitalize lg:text-xl" href={item.path}>
            <span class={`line-effect ${currentPath === item.path ? 'page-active' : ''}`}>
              {item.title}
            </span>
          </a>
        )
      ))}
    </div>

    <!-- Mobile Menu Toggle -->
    <div id="headerMenu" class="group relative flex h-full items-center md:hidden">
      <button aria-label="toggle" id="toggle" class="rounded-full p-2 text-primary group-hover:bg-primary group-hover:text-white">
        <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 256 256"><rect width="256" height="256" fill="none"></rect><line x1="40" y1="128" x2="216" y2="128" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></line><line x1="40" y1="64" x2="216" y2="64" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></line><line x1="40" y1="192" x2="216" y2="192" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></line></svg>
      </button>

      <div id="content" class="absolute right-5 top-16 z-10 hidden w-full min-w-max divide-y rounded-lg bg-white p-4 shadow-light">
        {navItems.map((item) => (
          item.subPaths.length > 0 ? (
            <div class="my-2 font-jost">
              <span class="mt-3 block w-full py-2 px-5 font-semibold capitalize">{item.title}</span>
              <div class="min-w-max space-y-2 rounded-b-lg bg-white">
                {item.subPaths.map((subItem) => (
                  <a href={subItem.path} class="flex w-full items-center rounded-[60px] py-2 px-5 font-jost text-sm text-grey-400 hover:bg-secondary-light hover:text-secondary">
                    <span>{subItem.title}</span>
                  </a>
                ))}
              </div>
            </div>
          ) : (
            <a class="block w-full px-5 pt-4 pb-2 font-semibold capitalize" href={item.path}>
              {item.title}
            </a>
          )
        ))}
      </div>
    </div>
  </nav>
</header>

<script>
  const toggle = document.getElementById('toggle');
  const content = document.getElementById('content');

  if (toggle && content) {
    toggle.addEventListener('click', () => {
      content.classList.toggle('hidden');
    });
    
    // Close when clicking outside
    document.addEventListener('click', (e) => {
      if (!toggle.contains(e.target as Node) && !content.contains(e.target as Node)) {
        content.classList.add('hidden');
      }
    });
  }
</script>
